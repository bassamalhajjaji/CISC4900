<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RetailFlow POS & Inventory Management System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <script src="app.js" defer></script>
</head>
<body>

  <!-- LOGIN SCREEN -->
  <div id="login-screen" class="auth-screen">
    <div class="auth-card">
      <div class="brand">
        <div class="brand-logo"></div>
        <div>
          <div class="brand-title">RetailFlow</div>
          <div class="brand-subtitle">POS & Inventory Management</div>
        </div>
      </div>

      <h2>Sign in</h2>
      <p class="text-muted">
        Use the demo admin account to access the dashboard.
      </p>
      <form id="login-form" class="auth-form">
        <div class="field">
          <label for="login-username">Username</label>
          <input id="login-username" placeholder="admin" required />
        </div>
        <div class="field">
          <label for="login-password">Password</label>
          <input id="login-password" type="password" placeholder="admin123" required />
        </div>
        <button type="submit" class="btn btn-primary auth-submit">
          Sign in
        </button>
        <div id="login-error" class="auth-error"></div>
        <div class="auth-hint text-muted">
          Default demo account: <strong>admin / admin123</strong>
        </div>
      </form>
    </div>
  </div>

  <!-- MAIN APP -->
  <div id="app-root" class="hidden">

    <header>
      <div class="brand">
        <div class="brand-logo"></div>
        <div>
          <div class="brand-title">RetailFlow</div>
          <div class="brand-subtitle">
            POS & Inventory Management System
          </div>
        </div>
      </div>
      <nav>
        <button class="nav-btn active" data-screen="dashboard">Dashboard</button>
        <button class="nav-btn" data-screen="inventory">Inventory</button>
        <button class="nav-btn" data-screen="pos">New Sale (POS)</button>
        <button class="nav-btn" data-screen="sales">Sales History</button>
        <button class="nav-btn" data-screen="settings">Settings</button>
        <span id="user-info" class="user-info"></span>
        <button id="btn-logout" class="nav-btn nav-btn-logout">Logout</button>
      </nav>
    </header>

    <main>
      <!-- DASHBOARD -->
      <section id="screen-dashboard">
        <div class="section-title">
          <div>
            <h2>Overview</h2>
            <div class="section-subtitle">
              Live snapshot of stock levels and recent sales performance.
            </div>
          </div>
          <span class="badge badge-success">Online · Backed by SQLite</span>
        </div>

        <div class="grid grid-3">
          <div class="card">
            <div class="card-header">
              <span class="stat-label">Total Products</span>
              <span class="badge">Inventory</span>
            </div>
            <div class="stat-value" id="stat-total-products">0</div>
            <div class="text-muted mt-1">Unique SKUs available.</div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="stat-label">Stock On Hand</span>
              <span class="badge">Units</span>
            </div>
            <div class="stat-value" id="stat-stock-on-hand">0</div>
            <div class="text-muted mt-1">Total quantity of all products.</div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="stat-label">Today's Revenue</span>
              <span class="badge badge-success">POS</span>
            </div>
            <div class="stat-value" id="stat-today-revenue">$0.00</div>
            <div class="text-muted mt-1" id="stat-today-date"></div>
          </div>
        </div>

        <div class="grid grid-2 mt-4">
          <div class="card">
            <div class="card-header">
              <span>Low Stock Alerts</span>
              <span class="badge badge-danger" id="badge-low-stock">0 items</span>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Product</th>
                  <th>SKU</th>
                  <th>Stock</th>
                </tr>
              </thead>
              <tbody id="table-low-stock">
              </tbody>
            </table>
            <div class="text-muted mt-2">
              Products below the minimum threshold are flagged here.
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span>Recent Sales</span>
              <span class="badge">Last 5</span>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th class="text-right">Units</th>
                  <th class="text-right">Total</th>
                </tr>
              </thead>
              <tbody id="table-recent-sales">
              </tbody>
            </table>
            <div class="text-muted mt-2">
              Sales processed through the RetailFlow POS.
            </div>
          </div>
        </div>
      </section>

      <!-- INVENTORY -->
      <section id="screen-inventory" class="hidden">
        <div class="section-title">
          <div>
            <h2>Inventory</h2>
            <div class="section-subtitle">
              Manage products, pricing, and stock levels.
            </div>
          </div>
          <button class="btn btn-primary" id="btn-reset-sample-data">
            Reset with Sample Data
          </button>
        </div>

        <div class="card">
          <div class="card-header">
            <span>Add / Edit Product</span>
          </div>
          <form id="form-product">
            <input type="hidden" id="product-id" />
            <div class="input-group">
              <div class="field">
                <label for="product-name">Name</label>
                <input id="product-name" required placeholder="e.g. Classic T-Shirt" />
              </div>
              <div class="field">
                <label for="product-sku">SKU</label>
                <input id="product-sku" required placeholder="e.g. TS-001" />
              </div>
              <div class="field">
                <label for="product-category">Category</label>
                <input id="product-category" placeholder="e.g. Apparel" />
              </div>
            </div>

            <div class="input-group">
              <div class="field">
                <label for="product-price">Unit Price ($)</label>
                <input id="product-price" type="number" step="0.01" min="0" required />
              </div>
              <div class="field">
                <label for="product-stock">Stock Qty</label>
                <input id="product-stock" type="number" min="0" required />
              </div>
              <div class="field">
                <label for="product-min-stock">Min Stock (alert)</label>
                <input id="product-min-stock" type="number" min="0" value="5" />
              </div>
            </div>

            <div class="flex-between mt-2">
              <div class="text-muted">
                Pro tip: Use consistent SKUs to keep reporting clean.
              </div>
              <div class="flex">
                <button type="button" class="btn btn-outline btn-sm" id="btn-clear-form">
                  Clear
                </button>
                <button type="submit" class="btn btn-primary btn-sm">
                  Save Product
                </button>
              </div>
            </div>
          </form>
        </div>

        <div class="card mt-3">
          <div class="card-header">
            <span>Product Catalog</span>
            <input id="inventory-search" placeholder="Search by name or SKU..." style="max-width: 220px;" />
          </div>
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>SKU</th>
                <th>Category</th>
                <th class="text-right">Price</th>
                <th class="text-right">Stock</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="table-products">
            </tbody>
          </table>
        </div>
      </section>

      <!-- POS -->
      <section id="screen-pos" class="hidden">
        <div class="section-title">
          <div>
            <h2>New Sale (POS)</h2>
            <div class="section-subtitle">
              Search products, build a cart, and complete the sale.
            </div>
          </div>
          <span class="badge badge-success">Real-time stock updates</span>
        </div>

        <div class="grid grid-2">
          <div class="card">
            <div class="card-header">
              <span>Find Product</span>
            </div>
            <div class="input-group">
              <div class="field">
                <label for="pos-search">Search by name or SKU</label>
                <input id="pos-search" placeholder="e.g. jeans, TS-001..." />
              </div>
              <div class="field">
                <label for="pos-quantity">Quantity</label>
                <input id="pos-quantity" type="number" min="1" value="1" />
              </div>
            </div>

            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>SKU</th>
                  <th class="text-right">Price</th>
                  <th class="text-right">Stock</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="table-pos-products">
              </tbody>
            </table>
          </div>

          <div class="card">
            <div class="card-header">
              <span>Cart</span>
              <button class="btn btn-outline btn-sm" id="btn-clear-cart">Clear Cart</button>
            </div>
            <div class="cart" id="cart-items"></div>
            <div class="mt-3">
              <div class="flex-between">
                <span class="text-muted">Items in Cart</span>
                <span id="cart-items-count">0</span>
              </div>
              <div class="flex-between mt-1">
                <span class="text-muted">Subtotal</span>
                <span id="cart-subtotal">$0.00</span>
              </div>
              <div class="flex-between mt-1">
                <span class="text-muted">Tax (8%)</span>
                <span id="cart-tax">$0.00</span>
              </div>
              <div class="flex-between mt-2" style="font-weight: 600;">
                <span>Total</span>
                <span id="cart-total">$0.00</span>
              </div>

              <button class="btn btn-primary mt-3" id="btn-complete-sale" style="width: 100%;">
                Complete Sale
              </button>

              <div class="text-muted mt-2" id="pos-message"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- SALES HISTORY -->
      <section id="screen-sales" class="hidden">
        <div class="section-title">
          <div>
            <h2>Sales History</h2>
            <div class="section-subtitle">
              Track all completed transactions and daily revenue.
            </div>
          </div>
          <button class="btn btn-outline" id="btn-export-sales-json">Export Sales JSON</button>
        </div>

        <div class="card">
          <div class="card-header">
            <span>All Sales</span>
            <select id="sales-filter">
              <option value="all">All dates</option>
              <option value="today">Today</option>
              <option value="7">Last 7 days</option>
              <option value="30">Last 30 days</option>
            </select>
          </div>
          <table>
            <thead>
              <tr>
                <th>Date / Time</th>
                <th class="text-right">Units</th>
                <th class="text-right">Total</th>
              </tr>
            </thead>
            <tbody id="table-sales">
            </tbody>
          </table>
        </div>
      </section>

      <!-- SETTINGS -->
      <section id="screen-settings" class="hidden">
        <div class="section-title">
          <div>
            <h2>Settings & Data</h2>
            <div class="section-subtitle">
              Control persistence and system-wide configuration.
            </div>
          </div>
        </div>

        <div class="grid grid-2">
          <div class="card">
            <h3>Data Controls</h3>
            <p class="text-muted">
              RetailFlow stores inventory and sales in a SQLite database on the server.
            </p>
            <div class="mt-2">
              <button class="btn btn-outline" id="btn-backup-data">Backup Data (Download)</button>
              <p class="text-muted mt-2" style="font-size: 0.8rem;">
                Downloads a JSON file containing products and sales. Great for your presentation.
              </p>
            </div>
            <div class="mt-3">
              <button class="btn btn-danger" id="btn-clear-data">
                Clear All Data
              </button>
              <p class="text-muted mt-2" style="font-size: 0.8rem;">
                ⚠️ Clears all inventory and sales records from the database (users remain).
              </p>
            </div>
          </div>

          <div class="card">
            <h3>Project Info</h3>
            <ul class="text-muted" style="font-size: 0.9rem; padding-left: 1.1rem;">
              <li>Project name: <strong>RetailFlow POS & Inventory</strong></li>
              <li>Tech stack: Node.js, Express, SQLite, HTML, CSS, JS</li>
              <li>Features:
                <ul style="padding-left: 1rem; margin-top: 0.25rem;">
                  <li>Login with session-based authentication</li>
                  <li>Inventory CRUD with low-stock alerts</li>
                  <li>POS cart with tax calculation</li>
                  <li>Sales history & revenue stats</li>
                  <li>Data backup/export as JSON</li>
                </ul>
              </li>
              <li>Deployed easily via Codespaces or any Node host.</li>
            </ul>
          </div>
        </div>
      </section>

      <div class="footer-note">
        RetailFlow · POS & Inventory Management System · Final Project Ready
      </div>
    </main>
  </div>

</body>
</html>